# Проект "Торговая сеть электроники"  

## Общее назначение
Сервис представляет из себя веб-приложение с API-интерфейсом и админ-панелью.
Реализует модель сети по продаже электронке.

<hr>

## Запуск проекта

1. Клонируйте исходники проекта:
```
git clone git@github.com:Anna-Kolmychek/trade_network.git
```
ИЛИ
```
git clone https://github.com/Anna-Kolmychek/trade_network.git
```

2. Создайте файл `.env` и запишите в него параметры для баз данных (основной и тестовой).
Пример структуры файла в `.env_sample`


3. Запустите проект с помощью docker-compose
```
docker-compose up --build
```

<ins>!!! После успешной сборки можно приступать к работе с проектом !!!</ins>


4. При желании вы можете создать админа
login: admin@email.com
password: 123

```
docker-compose exec app python3 manage.py create_su
```
Вход в админ-панель (при локальном запуске)
login: admin@email.com
password: 123
```
http://localhost:8000/admin/
```

5. При желании можете запустить тесты и узнать покрытие
```
docker-compose exec app coverage run --source='.' manage.py test && coverage report
```

<hr>

## Функциональность

### Пользователи
В сервисе реализован CRUD механим для создания пользователей. 
Доступна через админ-панель и API.
Доступ есть только у админов (is_staff = true).
Эндпоинты доступны по префиксу `/users/`.
В качестве логина используется почта.

Доступ к остальным эндпоинтам API есть только у зарегистрированных активных пользователей. 

### Продавцы
Основная модель (звено сети). Определяется следующими полями:
- Название; - _должно быть уникальным_
- Тип звена - _ссылка на таблицу с типами_
- Уровень звена - _уровень в иерахической цепочке от 0 до 2_
- Email;
- Страна;
- Город;
- Улица;
- Номер дома;
- Продукты; - _связь с таблицей продуктов по связи m2m_
- Поставщик (предыдущий по иерархии объект сети); - _ссылка на другое звено сети_
- Задолженность перед поставщиком в денежном выражении с точностью до копеек;
- Время создания (заполняется автоматически при создании).

Доступна для измнения через админ-панель и API.
Эндпоинты CRUD реализованы по префиксу `/traders/`

В модели стоит запрет на изменение задолженности через API, это поле можно поменять только в админ-панели.

Уровень звена выставляется автоматически в зависимости от связей с поставщиками.
При попытке выстроить цепочку более чем из 3 звеньев (создание или обновление звена), возникает ошибка.

При выводе списка продавцов есть возможность фильтрации по стране.

### Тип звена
Вспомогательная таблица, реализована для нормализации БД.
Содержит 3 записи, которые заполняются автоматически через миграции.
- Завод;
- Розничная сеть;
- Индивидуальный предприниматель.

Доступа через API к этой табилце нет.

### Продукты
Вспомогательная таблица, реализована для нормализации БД.
Содержит поля:
- Название; - _должно быть уникальным_
- Модель;
- Дата выхода продукта на рынок;

Доступна для измнения через API и админ-панель.
Эндпоинты CRUD реализованы по префиксу `/products/`

### Админ-панель
Доступ ко всем таблицам настроен в админ-панели. 
Для таблице Продавца на странице со списком добавлены:
- ссылку на «Поставщика»;
- фильтр по названию города;
- «admin action», очищающий задолженность перед поставщиком у выбранных объектов.


### Тестирование

Код сервиса покрыт тестами unittest.

### Docker

- Описан Dockerfile для приложения
- Создан docker-compose всех сервисов (postgersql для БД, веб-прилоежние).
